<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Forever & Always üíç</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Poppins:wght@300;500&display=swap" rel="stylesheet">

<style>
    /* ================= CORE STYLES ================= */
    :root {
        --primary-gold: #ffd700;
        --primary-pink: #ff4da6;
    }

    body {
        margin: 0;
        overflow: hidden; /* Prevents scrolling */
        font-family: 'Poppins', sans-serif;
        background: radial-gradient(circle at 30% 20%, #2b001a, #000000 70%);
        text-align: center;
        color: white;
        height: 100vh; /* Fallback */
        height: 100dvh; /* Mobile browser fix */
        width: 100vw;
        position: relative;
        touch-action: manipulation; /* Improves touch response */
        user-select: none; /* Prevents highlighting text on tap */
        -webkit-tap-highlight-color: transparent;
    }

    /* ================= BACKGROUND EFFECTS ================= */
    body::before {
        content: "";
        position: fixed;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(120deg, transparent, rgba(255,215,0,0.05), transparent);
        animation: shimmer 14s linear infinite;
        pointer-events: none;
        z-index: 0;
    }

    @keyframes shimmer {
        0% { transform: translateX(-50%) rotate(0deg); }
        100% { transform: translateX(50%) rotate(360deg); }
    }

    /* ================= UI LAYOUT ================= */
    #ui-container {
        position: relative;
        z-index: 2;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        box-sizing: border-box;
    }

    h1 {
        font-family: 'Playfair Display', serif;
        font-size: clamp(32px, 6vw, 48px); /* Responsive Text */
        background: linear-gradient(45deg, var(--primary-gold), var(--primary-pink));
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        color: transparent;
        margin-bottom: 15px;
        line-height: 1.2;
    }

    p {
        font-size: clamp(16px, 4vw, 20px);
        padding: 0 10px;
        opacity: 0.9;
        min-height: 50px;
        max-width: 600px;
    }

    /* ================= BUTTONS ================= */
    .btn-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
    }

    button {
        padding: 15px 30px;
        font-size: 18px;
        border-radius: 50px;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    .yes {
        background: linear-gradient(45deg, var(--primary-gold), var(--primary-pink));
        color: black;
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
        z-index: 10;
    }

    .yes:active {
        transform: scale(0.95);
    }

    .no {
        background: rgba(255,255,255,0.1);
        color: pink;
        border: 1px solid rgba(255,215,0,0.3);
        z-index: 10;
        transition: top 0.1s, left 0.1s; /* Faster movement on mobile */
    }

    /* ================= TOAST NOTIFICATION ================= */
    #toast {
        visibility: hidden;
        min-width: 250px;
        background-color: rgba(255, 255, 255, 0.9);
        color: #333;
        text-align: center;
        border-radius: 50px;
        padding: 16px;
        position: fixed;
        z-index: 100;
        left: 50%;
        bottom: 30px;
        transform: translateX(-50%);
        font-size: 14px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        opacity: 0;
        transition: opacity 0.3s, bottom 0.3s;
    }

    #toast.show {
        visibility: visible;
        opacity: 1;
        bottom: 50px;
    }

    /* ================= ANIMATIONS ================= */
    .heart {
        position: absolute;
        color: gold;
        animation: float 6s linear infinite;
        z-index: 1;
        opacity: 0.8;
        pointer-events: none;
    }

    @keyframes float {
        0% { transform: translateY(110vh) scale(1); opacity: 0; }
        10% { opacity: 0.8; }
        100% { transform: translateY(-10vh) scale(1.5) rotate(360deg); opacity: 0; }
    }
</style>
</head>
<body>

<audio id="bgMusic" loop preload="auto"><source src="static/music.mp3" type="audio/mpeg"></audio>
<audio id="clickSound" preload="auto"><source src="static/click.mp3" type="audio/mpeg"></audio>
<audio id="yesSound" preload="auto"><source src="static/yes.mp3" type="audio/mpeg"></audio>

<div id="ui-container">
    
    <div id="loadingScreen" style="text-align: center; z-index: 10;">
        <h1 style="color: gold;">Preparing something special...</h1>
        <div style="width: 80%; max-width: 300px; height: 4px; background: rgba(255,255,255,0.2); margin: 20px auto; border-radius: 2px;">
            <div id="progressBar" style="width: 0%; height: 100%; background: linear-gradient(45deg, gold, #ff4da6); border-radius: 2px; transition: width 3s ease;"></div>
        </div>
        <p style="font-size: 12px; margin-top: 10px; color: #aaa;">(Tap anywhere if music doesn't start)</p>
    </div>

    <div id="mainContent" class="main-content-wrapper" style="opacity: 0; display: none; transition: opacity 1s;">
        <h1>Hey You Girl ‚ù§Ô∏è</h1>
        <p id="loveText"></p>
        <div class="btn-container">
            <button class="yes" onclick="yesClicked()" id="yesBtn">YES üíñ</button>
            <button class="no" id="noBtn">NO üòú</button>
        </div>
    </div>

</div>

<div id="toast"></div>

<script>
/* ================= CONFIGURATION ================= */
const noComments = [
    "Nice try üòú", "Still no? ü§®", "You sure? üòè", "Think again üí≠", "Come onnn ü•∫",
    "Don't run üòÜ", "Caught you üòé", "Hehe nope üòÇ", "Too slow üê¢", "Click YES üòå"
];

let noClickCount = 0;
let musicPlayed = false;
const loveMessage = "From the moment I met you, my world became brighter ‚ú® You are my happiness, my peace, my forever üíï";

/* ================= MOBILE AUDIO HANDLING ================= */
// Android blocks autoplay. We unlock audio on the first interaction (Touch/Click)
function unlockAudio() {
    if (!musicPlayed) {
        const bgMusic = document.getElementById('bgMusic');
        bgMusic.play().then(() => {
            musicPlayed = true;
            console.log("Audio unlocked");
        }).catch(e => console.log("Waiting for interaction..."));
        
        // Also prime the effects so they don't lag later
        document.getElementById('clickSound').load();
        document.getElementById('yesSound').load();
    }
}

document.body.addEventListener('click', unlockAudio, { once: true });
document.body.addEventListener('touchstart', unlockAudio, { once: true });

function playAudio(id) {
    const audio = document.getElementById(id);
    if (audio) {
        if (id !== 'bgMusic') audio.currentTime = 0;
        audio.play().catch(e => console.log(e));
    }
}

/* ================= LOADING & TYPING ================= */
window.onload = function() {
    setTimeout(() => {
        document.getElementById('progressBar').style.width = '70%';
        setTimeout(startTypewriter, 1000);
    }, 500);
};

function startTypewriter() {
    const textElem = document.getElementById("loveText");
    let i = 0;
    
    function type() {
        if (i < loveMessage.length) {
            textElem.innerHTML += loveMessage.charAt(i);
            i++;
            setTimeout(type, 50);
        } else {
            finishLoading();
        }
    }
    type();
}

function finishLoading() {
    document.getElementById('progressBar').style.width = '100%';
    setTimeout(() => {
        document.getElementById('loadingScreen').style.display = 'none';
        const main = document.getElementById('mainContent');
        main.style.display = 'block';
        setTimeout(() => main.style.opacity = '1', 50);
    }, 500);
}

/* ================= NO BUTTON LOGIC (MOBILE OPTIMIZED) ================= */
const noBtn = document.getElementById('noBtn');

function showToast(message) {
    const toast = document.getElementById("toast");
    toast.innerText = message;
    toast.className = "show";
    setTimeout(() => { toast.className = toast.className.replace("show", ""); }, 2000);
}

function moveNoButton(e) {
    // Prevent default touch actions (scrolling/zooming) on the button
    if(e && e.cancelable) e.preventDefault(); 
    
    playAudio('clickSound');
    if (navigator.vibrate) navigator.vibrate(50); // Short vibration

    // Get random comment
    const comment = noComments[noClickCount % noComments.length];
    showToast(comment);
    noClickCount++;

    // Calculate safe boundaries
    const padding = 20;
    const btnWidth = noBtn.offsetWidth;
    const btnHeight = noBtn.offsetHeight;
    const maxX = window.innerWidth - btnWidth - padding;
    const maxY = window.innerHeight - btnHeight - padding;

    const randomX = Math.max(padding, Math.random() * maxX);
    const randomY = Math.max(padding, Math.random() * maxY);

    noBtn.style.position = "fixed";
    noBtn.style.left = randomX + "px";
    noBtn.style.top = randomY + "px";
}

// Trigger on BOTH touchstart (mobile) and mouseover (desktop)
noBtn.addEventListener('touchstart', moveNoButton, { passive: false });
noBtn.addEventListener('mouseover', moveNoButton);
noBtn.addEventListener('click', moveNoButton); // Fallback

/* ================= YES BUTTON LOGIC ================= */
function yesClicked() {
    playAudio('yesSound');
    if (navigator.vibrate) navigator.vibrate([200, 100, 200]);

    const uiContainer = document.getElementById('ui-container');
    uiContainer.innerHTML = `
        <h1 style='color:gold; font-family:Playfair Display;'>She Said YES üíçüíñ</h1>
        <h2 style='color:pink; font-size: 20px;'>You Are Mine Forever ü•∞</h2>
    `;

    launchConfetti();
    setTimeout(startGame, 2000);
}

/* ================= BACKGROUND HEARTS ================= */
function createHeart() {
    const heart = document.createElement("div");
    heart.classList.add("heart");
    heart.innerHTML = "‚ù§Ô∏è";
    heart.style.left = Math.random() * 100 + "vw";
    heart.style.fontSize = Math.random() * 15 + 10 + "px"; // Smaller hearts for mobile
    heart.style.animationDuration = Math.random() * 3 + 4 + "s";
    document.body.appendChild(heart);
    setTimeout(() => heart.remove(), 6000);
}
setInterval(createHeart, 400);

/* ================= CONFETTI CANVAS ================= */
function launchConfetti() {
    const canvas = document.createElement("canvas");
    Object.assign(canvas.style, {
        position: "fixed", top: "0", left: "0", 
        width: "100%", height: "100%", 
        pointerEvents: "none", zIndex: "5"
    });
    document.body.appendChild(canvas);

    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const pieces = Array.from({length: 150}, () => ({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height - canvas.height,
        size: Math.random() * 5 + 2,
        speed: Math.random() * 3 + 2,
        color: `hsl(${Math.random() * 360}, 100%, 50%)`
    }));

    function update() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        pieces.forEach(p => {
            p.y += p.speed;
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, p.size, p.size);
        });
        if (document.body.contains(canvas)) requestAnimationFrame(update);
    }
    update();
    setTimeout(() => canvas.remove(), 5000);
}

/* ================= MINI GAME ================= */
function startGame() {
    const container = document.getElementById('ui-container');
    container.innerHTML = ""; // Clear previous text
    
    const gameTitle = document.createElement("h2");
    gameTitle.innerText = "Catch My Heart üíò";
    gameTitle.style.color = "gold";
    container.appendChild(gameTitle);

    const timerDisplay = document.createElement("div");
    timerDisplay.style.color = "pink";
    timerDisplay.style.fontSize = "20px";
    timerDisplay.innerText = "Time: 10s";
    container.appendChild(timerDisplay);

    const heartBtn = document.createElement("button");
    heartBtn.innerHTML = "üíñ";
    Object.assign(heartBtn.style, {
        position: "fixed", fontSize: "30px", padding: "15px",
        borderRadius: "50%", border: "none", background: "gold",
        boxShadow: "0 0 20px gold", zIndex: "100", top: "50%", left: "50%"
    });

    // Handle Touch for Game
    heartBtn.addEventListener('touchstart', (e) => {
        e.preventDefault();
        playAudio('clickSound');
        endGame(true);
    });
    heartBtn.onclick = () => { playAudio('clickSound'); endGame(true); };

    document.body.appendChild(heartBtn);

    let timeLeft = 10;
    let gameActive = true;
    let moveInterval, timerInterval;

    function moveHeart() {
        if (!gameActive) return;
        const maxX = window.innerWidth - 80;
        const maxY = window.innerHeight - 80;
        heartBtn.style.left = Math.random() * maxX + "px";
        heartBtn.style.top = Math.random() * maxY + "px";
    }

    function endGame(won) {
        gameActive = false;
        clearInterval(timerInterval);
        clearInterval(moveInterval);
        heartBtn.remove();
        
        container.innerHTML = won 
            ? `<h2 style='color:pink;'>You Caught It! ‚ù§Ô∏è<br>I'm Yours!</h2>`
            : `<h2 style='color:pink;'>Time's up! <br>But you still caught my heart ‚ù§Ô∏è</h2>`;
    }

    moveHeart();
    moveInterval = setInterval(moveHeart, 700); // Slightly slower for mobile
    timerInterval = setInterval(() => {
        timeLeft--;
        timerDisplay.innerText = `Time: ${timeLeft}s`;
        if (timeLeft <= 0) endGame(false);
    }, 1000);
}
</script>
</body>
</html>
